      SUBROUTINE MWATNA(ICAM,WALINE,WASAMP,NALINE,NASAMP,*)
C     11 AUG 93   ...DDK...  PORTED TO UNIX
C     2 SEPT 82   ...GMY...  UPDATE VGR2 USING NOV 79 RAND REPORT
C     3 NOV 80   ...GMY...    INITIAL RELEASE
C ROUTINE TO CONVERT WA (LINE,SAMP) COORDINATES TO NA (LINE,SAMP)
      IMPLICIT REAL*8 (A-H,O-Z)
      REAL*4 WALINE,WASAMP,NALINE,NASAMP
      REAL*8 C(3,3),R(3)
      REAL*8 VGR1(3,3)/
     * 0.9999950588D0, 0.0031009104D0,-0.0005165310D0,
     *-0.0031011413D0, 0.9999950916D0,-0.0004467931D0,
     * 0.0005151430D0, 0.0004483927D0, 0.9999997668D0/
      REAL*8 VGR2(3,3)/
     * 0.9999966464D0, 0.0025303754D0, 0.0005516696D0,
     *-0.0025304697D0, 0.9999967838D0, 0.0001703842D0,
     *-0.0005512367D0,-0.0001717796D0, 0.9999998333D0/
      INTEGER*2 ICAM
      CHARACTER*50 MSG
C
      ISN = ABS(ICAM)
      IF(ISN.EQ.6.OR.ISN.EQ.7) GOTO 6
      IF(ISN.EQ.4.OR.ISN.EQ.5) GOTO 4
      WRITE(MSG,100) ISN
      CALL XVMESSAGE(MSG,' ')
  100 FORMAT(' **INVALID CAMERA S/N= ',I9)
      RETURN1
C
C          VGR2 WA,NA=4,5
    4 CALL MVE(7,18,VGR2,C,1,1)
      FNA = 1503.49D0
      FWA = 200.77D0
      GOTO 10
C          VGR1 WA,NA=6,7
    6 CALL MVE(7,18,VGR1,C,1,1)
      FNA = 1500.19D0
      FWA = 200.293D0
C
C          CONVERT TO MM (SCALE=PIXELS PER MM)
   10 SCALE = 84.821428D0
      X = (WASAMP-500.D0)/SCALE
      Y = (WALINE-500.D0)/SCALE
      Z = FWA
C          WA TO NA TRANSFORMATION
      DO 20 I=1,3
   20 R(I) = C(I,1)*X + C(I,2)*Y + C(I,3)*Z
C          CONVERT BACK TO PIXELS
      S = SCALE*FNA/R(3)
      NALINE = S*R(2) + 500.D0
      NASAMP = S*R(1) + 500.D0
      RETURN
      END
