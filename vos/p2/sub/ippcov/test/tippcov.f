C         TEST PROGRAM FOR IPPCOV SUBPROGRAM
      INCLUDE 'VICMAIN_FOR'
      SUBROUTINE MAIN44
      DOUBLE PRECISION OM(3,3),RS(3),EMA(9)
      REAL PTS(3),LINE
      DATA EMA/1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0/

      CHARACTER*560 BUFFER

      RLAT =0.
      RLON =0.

C  DEFAULT VARIABLES FOR IO

      RS(1) = -730950.0
      RS(2) = -339690.0
      RS(3) = -1209.3

      PTS(1) = 1815.0
      PTS(2) = 1500.19 * 84.821
      PTS(3) = SQRT(RS(1)**2+RS(2)**2+RS(3)**2)

      OM(1,1) = 0.407057464D0
      OM(2,1) = 0.112318814D0
      OM(3,1) = 0.906470418D0
      OM(1,2) = -0.874813914D0
      OM(2,2) = -0.237469494D0
      OM(3,2) = 0.422266245D0
      OM(1,3) = 0.262687564D0
      OM(2,3) = -0.964879572D0
      OM(3,3) = 0.0015943704D0
      LINE = 614.10
      SAMP = 614.38
      OAL = 500.0
      OAS = 500.0
      FLAG = 99.99
 
      CALL XVMESSAGE(' ',' ')
      CALL XVMESSAGE('BEFORE CONVERSION FROM LINE/SAMPLE TO LAT/LONG:',
     .               ' ')
      WRITE(BUFFER,100)RLAT,RLON,LINE,SAMP,FLAG,RS,OM,PTS,OAL,OAS
      CALL XVMESSAGE(BUFFER(  2: 80),' ')
      CALL XVMESSAGE(BUFFER( 82:160),' ')
      CALL XVMESSAGE(BUFFER(162:240),' ')
      CALL XVMESSAGE(BUFFER(242:320),' ')
      CALL XVMESSAGE(BUFFER(322:400),' ')
      CALL XVMESSAGE(BUFFER(402:480),' ')
      CALL XVMESSAGE(BUFFER(482:560),' ')
      CALL XVMESSAGE(' ',' ')

      CALL IPPCOV(RLAT,RLON,LINE,SAMP,PTS,RS,OM,EMA,OAL,OAS,FLAG)

      CALL XVMESSAGE('AFTER CONVERSION TO LAT/LONG:',' ')
      WRITE(BUFFER,100)RLAT*57.0,RLON*57.0,LINE,SAMP,FLAG,RS,OM,PTS,
     1      OAL,OAS
      CALL XVMESSAGE(BUFFER(  2: 80),' ')
      CALL XVMESSAGE(BUFFER( 82:160),' ')
      CALL XVMESSAGE(BUFFER(162:240),' ')
      CALL XVMESSAGE(BUFFER(242:320),' ')
      CALL XVMESSAGE(BUFFER(322:400),' ')
      CALL XVMESSAGE(BUFFER(402:480),' ')
      CALL XVMESSAGE(BUFFER(482:560),' ')
      CALL XVMESSAGE(' ',' ')
      CALL XVMESSAGE(
     . 'Repeat test case in C to test C interface: zippcov', ' ')

      call tzippcov( OM, RS, EMA, PTS)

      RETURN
  100 FORMAT(' LAT: ',F8.2,'  LONG: ',F8.2,4X,'LINE: ',F8.2,'  SAMP: ',
     1       F8.2,' FLAG: ',F5.1,4X,' RS: ',3(E11.5,4X),30X,' OM:',2(
     3       3(E11.5,4X),35X),3(E11.5,4X),31X,' PTS: ',3(F10.2,2X),
     4       'OAL: ',F8.2,2X,'OAS: ',F8.2,30X)
      END
