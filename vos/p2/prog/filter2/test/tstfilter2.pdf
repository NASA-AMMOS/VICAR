procedure
refgbl $echo
body
let _onfail="continue"
let $echo="yes"
WRITE "THIS IS A TEST OF MODULE FILTER2"
WRITE "FIL2 WILL GENERATE AND PASS PARAMETERS TO PROGRAM"
WRITE "FILTER VIA A THE PROCEDURE FILTER2."
WRITE "THE IMPORTANT RESULT OF EACH CASE IS THE PRINTOUT"
WRITE "IDENTIFIED AS 'TOP LEFT WEIGHT QUADRANT'.  EACH"
WRITE "CASE WILL HAVE ITS IBM EQUIVALENT LISTED HERE."
WRITE ""
WRITE "FIRST, ONLY WEIGHTS BEING GENERATED, NO ACTUAL FILTERING."
FILTER2 NLW=1 NSW=11  +
       PSF=(      +
       1.,.99,.9617,.9175,.8592,.7975,.7292,.6617,   +
       .5967,.5308,.4717,.415,.3633,.315,.27, +
       .2292,.1933,.1592,.1325,.105,.0842  )
WRITE "IBM WEIGHTS:  2216  2388  2550  2673  2752  32000"
WRITE ""
WRITE "FILTER A GEN'D IMAGE   1-DIM FILTER"
GEN OUT=F.INP NL=50 NS=50
GEN OUT=G.FIL NL=50 NS=50
LIST F.INP SIZE=(1,1,10,10)
FILTER2 F.INP G.FIL NLW=1 NSW=11 sn=10. +
       PSF=(      +
       1.,.99,.9617,.9175,.8592,.7975,.7292,.6617,   +
       .5967,.5308,.4717,.415,.3633,.315,.27, +
       .2292,.1933,.1592,.1325,.105,.0842  )
WRITE "IBM WEIGHTS:  1160  3172  5607  7512  8795  -32000"
LIST G.FIL SIZE=(1,1,10,10)
WRITE ""
WRITE "DO A 2-DIM FILTER"
FILTER2 F.INP G.FIL NLW=11 NSW=11 sn=6. +
       PSF=(      +
       1.,.99,.9617,.9175,.8592,.7975,.7292,.6617,   +
       .5967,.5308,.4717,.415,.3633,.315,.27, +
       .2292,.1933,.1592,.1325,.105,.0842  )
WRITE "IBM WEIGHTS:  117   195    388    409    366    352"
WRITE "              195   419    352    405    578    640"
WRITE "              388   352    512    767    668    604"
WRITE "              409   405    767    555    813   1072"
WRITE "              366   578    668    813   1227    298"
WRITE "              352   640    604   1072    298 -32000"
WRITE ""
LIST G.FIL SIZE=(1,1,10,10)
WRITE "NOW ANOTHER 2-DIM FILTER"
FILTER2 F.INP G.FIL SN=6. NLW=11 NSW=11  +
       MTF=(      +
       1.,0.,.99,.025,.9617,.05,.9175,.075                     +
                                  .8592,.1,.7975,.125,.7292,.15,.6617,.175   +
       .5967,.2,.5308,.225,.4717,.25,.415,.275,.3633,.3,.315,.325,.27,.35 +
       .2292,.375,.1933,.4,.1592,.425,.1325,.45,.105,.475,.0842,.5  )
WRITE "IBM WEIGHTS:"
WRITE "              58   -57    -59    87    152    154"
WRITE "             -57   -11    153   -57   -255   -287"
WRITE "             -59   153   -197  -150    361    534"
WRITE "              87   -57   -150   636    -89   -804"
WRITE "             152  -255    361   -89  -2403  -2423"
WRITE "             154  -287    534  -804  -2423  32000"
LIST G.FIL SIZE=(1,1,10,10)
end-proc
