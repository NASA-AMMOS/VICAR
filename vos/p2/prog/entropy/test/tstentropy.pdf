procedure
refgbl $autousage
refgbl $echo
refgbl $syschar

body
local dir string

let $autousage="none"
let _onfail="continue"

enable-log

let $echo="no"
write "Generic Image Test"
write ""
write "test image 1 - entropy should be 0"
let $echo="yes"
gen a.img 16 16
entropy a.img

let $echo="no"
write "test image 2 - entropy should be 1.0"
let $echo="yes"
gen b.img 16 16 mod=2
entropy b.img

let $echo="no"
write "test image 3 (byte) - entropy should be 0.811278"
let $echo="yes"
gen c.img 16 16 mod=4
entropy c.img 

let $echo="no"
write "test image 4 (half) - entropy should be 0.811278,"
write "local variable ent should be filled by that value"
let $echo="yes"
local out_ent real
cform c.img d.img  'half
entropy d.img value=out_ent
write "out_ent: &out_ent"

let $echo="no"
write ""
write ""
write "GALILEO Test"
if ($syschar(1)="UNIX")
   let dir = "/project/test_work/testdata/mipl/gll/"
else
   let dir = "wms_test_work:[testdata.mipl.gll]"
end-if
write ""
write "Testing AREA parameter"
let $echo="yes"
entropy data/s0349666345.2.byt area=(1,1,100,100)

let $echo="no"
write ""
write "Testing PHIST keyword to generate normalized difference histogram"
write "The Histogram generated by the PHIST keyword has data range from "
write "-4095 to 4095."
let $echo="yes"
entropy data/s0249220600.1.byt 'phist

let $echo="no"
write ""
write "Testing ZEROES keyword"
let $echo="yes"
entropy data/s0249220600.1.byt 'phist 'zeroes

let $echo="no"
write ""
write "Testing DISTFILE parameter to generate difference histogram file"
let $echo="yes"
entropy data/s0349632122.1.byt distfile=gll.dist

let $echo="no"
write ""
write "Testing VALUE parameter"
entropy data/s0349758952.18.byt value=out_ent
write "out_ent: &out_ent"

let $echo="no"
write ""
write "Testing MODE parameter.  GLL label should not be updated."
let $echo="yes"
ush cp data/s0349759013.8.byt ./
label-list s0349759013.8.byt 'nousrtim
entropy s0349759013.8.byt 'label
label-list s0349759013.8.byt 'nousrtim

let $echo="no"
write ""
write ""
write "CASSINI Test"
if ($syschar(1)="UNIX")
   let dir = "/project/test_work/testdata/cassini/iss/"
else
   let dir = "wms_test_work:[testdata.cassini.iss]"
end-if
write "Testing AREA parameter"
let $echo="yes"
entropy data/sum2.15.byt area=(1,1,100,100)
 
let $echo="no"
write ""
write "Testing PHIST keyword to generate normalized difference histogram"
let $echo="yes"
entropy data/sum2.1.byt 'phist
 
let $echo="no"
write ""
write "Testing ZEROES keyword"
let $echo="yes"
entropy data/sum2.2.byt 'phist 'zeroes
 
let $echo="no"
write ""
write "Testing DISTFILE parameter to generate difference histogram file"
let $echo="yes"
entropy data/sum2.3.byt distfile=cassini.dist

let $echo="no"
write ""
write "Testing VALUE parameter"
entropy data/sum2.7.byt value=out_ent
write "out_ent: &out_ent"
 
let $echo="no"
write ""
write "Testing MODE parameter.  History label should be updated."
let $echo="yes"
ush cp data/sum2.38.byt ./
label-list sum2.38.byt 'nousrtim
entropy sum2.38.byt 'label
label-list sum2.38.byt 'nousrtim

let $echo="no"
 
disable-log

ush rm a.img b.img cassini.dist c.img d.img gll.dist s0349759013.8.byt sum2.38.byt

end-proc
