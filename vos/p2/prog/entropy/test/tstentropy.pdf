procedure
refgbl $autousage
refgbl $echo
refgbl $syschar

body
local dir string

let $autousage="none"
let _onfail="continue"

enable-log

let $echo="no"
write "Generic Image Test"
write ""
write "test image 1 - entropy should be 0"
let $echo="yes"
gen a.img 16 16
entropy a.img

let $echo="no"
write "test image 2 - entropy should be 1.0"
let $echo="yes"
gen b.img 16 16 mod=2
entropy b.img

let $echo="no"
write "test image 3 (byte) - entropy should be 0.811278"
let $echo="yes"
gen c.img 16 16 mod=4
entropy c.img 

let $echo="no"
write "test image 4 (half) - entropy should be 0.811278,"
write "local variable ent should be filled by that value"
let $echo="yes"
local out_ent real
cform c.img d.img  'half
entropy d.img value=out_ent
disp out_ent

let $echo="no"
write ""
write ""
write "GALILEO Test"
if ($syschar(1)="UNIX")
   let dir = "/project/test_work/testdata/mipl/gll/"
else
   let dir = "wms_test_work:[testdata.mipl.gll]"
end-if
write ""
write "Testing AREA parameter"
let $echo="yes"
entropy &"dir"s0349666345.2 area=(1,1,100,100)

let $echo="no"
write ""
write "Testing PHIST keyword to generate normalized difference histogram"
write "The Histogram generated by the PHIST keyword has data range from "
write "-4095 to 4095."
let $echo="yes"
entropy /project/test_work/testdata/mipl/gll/s0249220600.1 'phist

let $echo="no"
write ""
write "Testing ZEROES keyword"
let $echo="yes"
entropy /project/test_work/testdata/mipl/gll/s0249220600.1 'phist 'zeroes

let $echo="no"
write ""
write "Testing DISTFILE parameter to generate difference histogram file"
let $echo="yes"
entropy &"dir"s0349632122.1 distfile=gll.dist

let $echo="no"
write ""
write "Testing VALUE parameter"
entropy &"dir"s0349758952.18 value=out_ent
disp out_ent

let $echo="no"
write ""
write "Testing MODE parameter.  GLL label should not be updated."
let $echo="yes"
copy &"dir"s0349759013.8 s0349759013.8
label-list s0349759013.8
entropy s0349759013.8 'label
label-list s0349759013.8

let $echo="no"
write ""
write ""
write "CASSINI Test"
if ($syschar(1)="UNIX")
   let dir = "/project/test_work/testdata/cassini/iss/"
else
   let dir = "wms_test_work:[testdata.cassini.iss]"
end-if
write "Testing AREA parameter"
let $echo="yes"
entropy &"dir"sum2.15 area=(1,1,100,100)
 
let $echo="no"
write ""
write "Testing PHIST keyword to generate normalized difference histogram"
let $echo="yes"
entropy /project/test_work/testdata/cassini/iss/sum2.1 'phist
 
let $echo="no"
write ""
write "Testing ZEROES keyword"
let $echo="yes"
entropy /project/test_work/testdata/cassini/iss/sum2.2 'phist 'zeroes
 
let $echo="no"
write ""
write "Testing DISTFILE parameter to generate difference histogram file"
let $echo="yes"
entropy &"dir"sum2.3 distfile=cassini.dist

let $echo="no"
write ""
write "Testing VALUE parameter"
entropy &"dir"sum2.7 value=out_ent
disp out_ent
 
let $echo="no"
write ""
write "Testing MODE parameter.  History label should be updated."
let $echo="yes"
copy &"dir"sum2.38 sum2.38
label-list sum2.38
entropy sum2.38 'label
label-list sum2.38

let $echo="no"
ush rm *.img
ush rm sum2.38
ush rm s0*.*
 
disable-log

end-proc

