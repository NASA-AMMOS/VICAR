process help=*
PARM  INP	TYPE=STRING	COUNT=2
PARM  OUT	TYPE=STRING
PARM  STIME	TYPE=INTEGER	COUNT=3		DEFAULT=(0,0,0)
END-PROC

.TITLE
VICAR/IBIS Program TIMSNAV
.HELP
PURPOSE:
TIMSNAV adds NAV data to the TIMS Auxiliary file.
It requires two inputs, the TIMS Auxiliary file created with the 'ALL
option and the NAVLOG output file.  The output is a new TIMS Auxiliary
file with eight additional fields (Radar Altitude, Pressure Altitude,
Total Air Temp, Dew Point, PRT-5, Wind Angle, Wind Speed, and Ground
Elevation) plus NAV data inserted into seven of the existing fields.

The data is stored as follows :

Samp	Data
 1	Ref Temp 1
 2	Ref Temp 2
 3-14	Data for 6 channels
15	Year
16	Month
17	Day
18	Hour
19	Minute
20	Second
21	(Sortie)
22	Line
23	Gain
24	Scan speed
25	Latitude in degrees *
26	Longitude in degrees *
27	True Heading *
28	Pitch *
29	Roll *
30	Ground Speed *
31	Drift *
32	Radar Altitude (meters) **
33	Pressure Altitude (meters) **
34	Total Air Temp **
35	Dew Point **
36	PRT-5 **
37	Wind Angle **
38	Wind Speed **
39	Ground Elevation (meters)  (33-32) **
40      Ambient Temperature #1 ***
41      Ambient Temperature #2 ***

* indicates inserted data
** indicates new data
*** indicates relocated data

EXECUTION:

TIMSNAV (TIMS.AUX,NAV.INT) TIMS.NAV

METHOD:

TIMSNAV reads time from the TIMS data and uses the data for the
corresponding time in the NAV data.  The TIMS time is typically given
in integer seconds even though data is taken up to 25 times a second.
When two consecutive times are the same, or inconsisent, TIMSNAV will 
adjust the time according to the scanning speed to get fractional seconds.

It then finds the two times in the NAV data that cover this time
and interpolates between the data entries for the two times.
The TIMS time is sometimes missing (stored as zero) and TIMSNAV
uses the scanning speed to calculate the expected time.

However, if the time is missing at the beginning of the file, the
user must manually input it with the STIME option.

PARAMETERS:

STIME=(Hour, Minute, Second) must be used when start time is missing.


Original Programmer :  Howard J. Frieden   February 1991
Cognizant Programmer:  Howard J. Frieden 

.LEVEL1
.VARIABLE INP
Input filenames.  
First input is the
TIMSLOG Auxiliary file
created with 'ALL option.
Second file is the
NAVLOG output file that
includes the TIMS time.
.VARIABLE OUT
Output filename.
A new Auxiliary file.
.VARIABLE STIME
When initial time
is invalid, user 
must input it as
(Hour, Minute, Second)
