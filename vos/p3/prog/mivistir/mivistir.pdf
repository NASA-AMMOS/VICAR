Process help=*
parm  INP	(string,80)			count=3
parm  OUT	(string,80)
parm  SIZE	integer	default=(1,1,0,0)	count=4
parm  SL	integer	default=1
parm  SS	integer	default=1
parm  NL	integer	default=0
parm  NS	integer	default=0
parm  MODINP	(string,40)
parm  MODOUT	(string,40)	count=(0:1)	default=--
parm  MODTAB	(string,40)	count=(0:1)	default=--
End-proc

.TITLE
TAE PROCESS MIVISTIR
.HELP
PURPOSE:

   MIVISTIR is a program that accepts as input MIVIS TIR brightness temperature
at sensor image data and outputs upwelling radiance at surface for the thermal 
infrared channels.  Also required as input are a valid MODTRAN input file, to 
define the atmospheric model, the MIVIS TIR spectral response file, and the 
MIVIS radiance lookup table.


OPERATION:

   MIVITIR takes as input the 10 Channels of MIVIS TIR brightness temperature
at sensor data in units of degrees Celsius, multiplied by 10, a file 
containing the the MIVIS TIR spectral response functions, and the MIVIS
temperature to radiance lookup table. The second file must be a VICAR labelled
file consisting of ten lines (one for each TIR channel) and 900 samples (one 
for the spectral response at each wavenumber from 601 to 1500). The spectral 
response functions must be normalized, i.e., the sum of all values on each line
must be 1.0.  The third file must be a temperature to radiance lookup table
in the format common to MIVIS, MASTER, MAS, and TIMS.
   The atmospheric model used is defined by a user supplied MODTRAN input
file.  MIVISTIR uses these parameters to run MODTRAN twice; once with a
nadir looking geometry, and once for the case of viewing at maximum deflection
from nadir.  From these two runs, the atmospheric transmittance, path
radiance, and downwelling sky radiance at surface are calculated for the ten
MIVIS TIR bandpasses.  The downwelling sky radiance values are placed in
the VICAR label of the output dataset.
   Values of transmittance and path radiance are calculated for each pixel
location in the scene by interpolation, where it is assumed that each
quantity varies linearly with path length.
   The upwelling radiance at surface is then computed by the following 
formula:

        Rad(at sensor) = Rad(upwelling)*transmittance + Rad(path)

It should be noted that the output quantity (upwelling radiance) of MIVISTIR
differs from the output quantity of TIMSCAL2 (surface emitted radiance). It
it includes both the surface emitted component plus the surface reflected
component.
   The output dataset consists of 10 channels of halfword (16 bit signed
integer) pixels, in units of milliWatts per square meter per steradian per
micrometer.  Note that these units are 1000 times smaller than the input
units.


WRITTEN BY:  Ron Alley         November 68

COGNIZANT PROGRAMMER:  Ron Alley

REVISION: New

.LEVEL1
.VARI INP
(1) MIVIS TIR brightness
    temperature image (10*deg C)
(2) MIVIS TIR calibration file
(3) MIVIS radiance lookup table
.VARI OUT
Output data set of the 10 MIVIS
TIR bands, for upwelling
radiance at surface.
.VARI SIZE
The standard  VICAR output size
field.
.VARI SL
Starting line
.VARI SS
Starting sample
.VARI NL
Number of lines
.VARI NS
Number of samples
.VARI MODINP
Dataset name for the MODTRAN
input file, containing the
atmospheric data relevant to
this image.
.VARI MODOUT
Dataset name for MODTRAN
output report file.
.VARI MODTAB
Dataset name for MODTRAN
output tabular file.
.LEVEL2
.VARI INP
The first file should contain the 10 channels of MIVIS TIR image data,
calibrated as bightness temperature at sensor, in units of degrees Celsius
multiplied by 10.0.

The second file should be the MIVIS TIR calibration file (in VICAR format)
that is in effect for the date of data acquisition.

The third file should be the MIVIS TIR radiance lookup table file (in VICAR 
format) that is in effect for the date of data acquisition.
.VARI OUT
The output dataset will contain upwelling radiance at surface data for the
ten MASTER TIR channels, in units of milliWatts per sqare meter per steradian 
per micrometer.  Output pixels are halfword (16 bit signed integer).
.VARI SIZE
The standard VICAR output size field.   Default will process
the entire data set.
	Example: SIZE = (1,1,200,755)
.VARI SL
Starting line (same as SIZE(1)).
.VARI SS
Starting sample and number of samples are ignored.  The entire width of the
input image is always processed.
.VARI NL
Number of lines (same as SIZE(3)).
.VARI NS
Starting sample and number of samples are ignored.  The entire width of the
input image is always processed.
.VARI MODINP
   The atmospheric and geometric parameters needed by this program to run
   MODTRAN are supplied by the user providing a valid MODTRAN input (TAPE5)
   file.  This file may be generated by the stand alone program "modin",
   or by any other means convenient to the user.
.VARI MODOUT
   As a default, the report file generated by MODTRAN is discarded 
   at the conclusion of the MODTRAN run.  If a dataset name is given
   as the parameter value to MODOUT, the report for the nadir looking case
   of MODTRAN is saved in that dataset.
.VARI MODTAB
   As a default, the tabular file generated by MODTRAN is discarded 
   at the conclusion of the MODTRAN run.  If a dataset name is given
   as the parameter value to MODTAB, the report for the nadir looking case
   of MODTRAN is saved in that dataset.
.END
